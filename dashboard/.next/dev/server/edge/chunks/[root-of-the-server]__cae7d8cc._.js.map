{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/logger.ts"],"sourcesContent":["/**\n * Structured logger for serverless environments.\n *\n * Outputs JSON to stdout/stderr so Vercel Log Drains, Axiom, Datadog,\n * or any log aggregator can parse, filter, and alert on events.\n *\n * Usage:\n *   import { logger } from '@/lib/logger'\n *   logger.error('webhook.signature_invalid', { ip, path })\n *   logger.warn('rate_limit.exceeded', { userId, endpoint })\n *   logger.info('generate.success', { userId, model, tokens })\n */\n\ntype LogLevel = 'info' | 'warn' | 'error'\n\ninterface LogEntry {\n  level: LogLevel\n  event: string\n  timestamp: string\n  [key: string]: unknown\n}\n\nfunction emit(level: LogLevel, event: string, meta?: Record<string, unknown>) {\n  const entry: LogEntry = {\n    level,\n    event,\n    timestamp: new Date().toISOString(),\n    ...meta,\n  }\n\n  const line = JSON.stringify(entry)\n\n  switch (level) {\n    case 'error':\n      console.error(line)\n      break\n    case 'warn':\n      console.warn(line)\n      break\n    default:\n      console.log(line)\n  }\n}\n\nexport const logger = {\n  info: (event: string, meta?: Record<string, unknown>) => emit('info', event, meta),\n  warn: (event: string, meta?: Record<string, unknown>) => emit('warn', event, meta),\n  error: (event: string, meta?: Record<string, unknown>) => emit('error', event, meta),\n\n  /** Convenience: log an Error object with stack trace */\n  exception: (event: string, err: unknown, meta?: Record<string, unknown>) => {\n    const errorInfo =\n      err instanceof Error\n        ? { errorMessage: err.message, errorStack: err.stack }\n        : { errorMessage: String(err) }\n    emit('error', event, { ...errorInfo, ...meta })\n  },\n\n  /** Security-relevant event (auth failure, rate limit, suspicious input) */\n  security: (event: string, meta?: Record<string, unknown>) =>\n    emit('warn', event, { ...meta, security: true }),\n}\n\n/**\n * Extract client IP from request headers (Vercel sets x-forwarded-for).\n */\nexport function getClientIp(request: Request): string {\n  return (\n    request.headers.get('x-forwarded-for')?.split(',')[0]?.trim() ||\n    request.headers.get('x-real-ip') ||\n    'unknown'\n  )\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;CAWC;;;;;;AAWD,SAAS,KAAK,KAAe,EAAE,KAAa,EAAE,IAA8B;IAC1E,MAAM,QAAkB;QACtB;QACA;QACA,WAAW,IAAI,OAAO,WAAW;QACjC,GAAG,IAAI;IACT;IAEA,MAAM,OAAO,KAAK,SAAS,CAAC;IAE5B,OAAQ;QACN,KAAK;YACH,QAAQ,KAAK,CAAC;YACd;QACF,KAAK;YACH,QAAQ,IAAI,CAAC;YACb;QACF;YACE,QAAQ,GAAG,CAAC;IAChB;AACF;AAEO,MAAM,SAAS;IACpB,MAAM,CAAC,OAAe,OAAmC,KAAK,QAAQ,OAAO;IAC7E,MAAM,CAAC,OAAe,OAAmC,KAAK,QAAQ,OAAO;IAC7E,OAAO,CAAC,OAAe,OAAmC,KAAK,SAAS,OAAO;IAE/E,sDAAsD,GACtD,WAAW,CAAC,OAAe,KAAc;QACvC,MAAM,YACJ,eAAe,QACX;YAAE,cAAc,IAAI,OAAO;YAAE,YAAY,IAAI,KAAK;QAAC,IACnD;YAAE,cAAc,OAAO;QAAK;QAClC,KAAK,SAAS,OAAO;YAAE,GAAG,SAAS;YAAE,GAAG,IAAI;QAAC;IAC/C;IAEA,yEAAyE,GACzE,UAAU,CAAC,OAAe,OACxB,KAAK,QAAQ,OAAO;YAAE,GAAG,IAAI;YAAE,UAAU;QAAK;AAClD;AAKO,SAAS,YAAY,OAAgB;IAC1C,OACE,QAAQ,OAAO,CAAC,GAAG,CAAC,oBAAoB,MAAM,IAAI,CAAC,EAAE,EAAE,UACvD,QAAQ,OAAO,CAAC,GAAG,CAAC,gBACpB;AAEJ"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/lib/supabase/proxy.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { NextResponse, type NextRequest } from 'next/server'\nimport { logger } from '@/lib/logger'\n\nexport async function updateSession(request: NextRequest) {\n  let supabaseResponse = NextResponse.next({\n    request,\n  })\n\n  try {\n    const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n    const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n    if (!supabaseUrl || !supabaseAnonKey) {\n      logger.warn('proxy.missing_env_vars', { route: 'middleware' })\n      return supabaseResponse\n    }\n\n    const supabase = createServerClient(\n      supabaseUrl,\n      supabaseAnonKey,\n      {\n        cookies: {\n          getAll() {\n            return request.cookies.getAll()\n          },\n          setAll(cookiesToSet) {\n            cookiesToSet.forEach(({ name, value }) =>\n              request.cookies.set(name, value),\n            )\n            supabaseResponse = NextResponse.next({\n              request,\n            })\n            cookiesToSet.forEach(({ name, value, options }) =>\n              supabaseResponse.cookies.set(name, value, options),\n            )\n          },\n        },\n      },\n    )\n\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    if (\n      request.nextUrl.pathname.startsWith('/protected') &&\n      !user\n    ) {\n      const url = request.nextUrl.clone()\n      url.pathname = '/auth/login'\n      return NextResponse.redirect(url)\n    }\n\n    if (\n      request.nextUrl.pathname.startsWith('/dashboard') &&\n      !user\n    ) {\n      const url = request.nextUrl.clone()\n      url.pathname = '/auth/login'\n      return NextResponse.redirect(url)\n    }\n  } catch (e) {\n    logger.exception('proxy.session_error', e, { path: request.nextUrl.pathname })\n    return supabaseResponse\n  }\n\n  // IMPORTANT: You *must* return the supabaseResponse object as it is.\n  // If you're creating a new response object with NextResponse.next() make sure to:\n  // 1. Pass the request in it, like so:\n  //    const myNewResponse = NextResponse.next({ request })\n  // 2. Copy over the cookies, like so:\n  //    myNewResponse.cookies.setAll(supabaseResponse.cookies.getAll())\n  // 3. Change the myNewResponse object to fit your needs, but avoid changing\n  //    the cookies!\n  // 4. Finally:\n  //    return myNewResponse\n  // If this is not done, you may be causing the browser and server to go out\n  // of sync and terminate the user's session prematurely!\n\n  return supabaseResponse\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;AACA;;;;AAEO,eAAe,cAAc,OAAoB;IACtD,IAAI,mBAAmB,gMAAY,CAAC,IAAI,CAAC;QACvC;IACF;IAEA,IAAI;QACF,MAAM;QACN,MAAM;QAEN;;QAKA,MAAM,WAAW,IAAA,uMAAkB,EACjC,aACA,iBACA;YACE,SAAS;gBACP;oBACE,OAAO,QAAQ,OAAO,CAAC,MAAM;gBAC/B;gBACA,QAAO,YAAY;oBACjB,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,GACnC,QAAQ,OAAO,CAAC,GAAG,CAAC,MAAM;oBAE5B,mBAAmB,gMAAY,CAAC,IAAI,CAAC;wBACnC;oBACF;oBACA,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,iBAAiB,OAAO,CAAC,GAAG,CAAC,MAAM,OAAO;gBAE9C;YACF;QACF;QAGF,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IACE,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,iBACpC,CAAC,MACD;YACA,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;YACjC,IAAI,QAAQ,GAAG;YACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;QAC/B;QAEA,IACE,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,iBACpC,CAAC,MACD;YACA,MAAM,MAAM,QAAQ,OAAO,CAAC,KAAK;YACjC,IAAI,QAAQ,GAAG;YACf,OAAO,gMAAY,CAAC,QAAQ,CAAC;QAC/B;IACF,EAAE,OAAO,GAAG;QACV,+HAAM,CAAC,SAAS,CAAC,uBAAuB,GAAG;YAAE,MAAM,QAAQ,OAAO,CAAC,QAAQ;QAAC;QAC5E,OAAO;IACT;IAEA,qEAAqE;IACrE,kFAAkF;IAClF,sCAAsC;IACtC,0DAA0D;IAC1D,qCAAqC;IACrC,qEAAqE;IACrE,2EAA2E;IAC3E,kBAAkB;IAClB,cAAc;IACd,0BAA0B;IAC1B,2EAA2E;IAC3E,wDAAwD;IAExD,OAAO;AACT"}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { updateSession } from '@/lib/supabase/proxy'\nimport { logger } from '@/lib/logger'\nimport { NextResponse, type NextRequest } from 'next/server'\n\nexport async function middleware(request: NextRequest) {\n  try {\n    return await updateSession(request)\n  } catch (e) {\n    logger.exception('middleware.error', e, { path: request.nextUrl.pathname })\n    return NextResponse.next()\n  }\n}\n\nexport const config = {\n  matcher: [\n    '/dashboard/:path*',\n    '/protected/:path*',\n    /*\n     * Exclude /auth/callback from middleware to avoid interfering with the\n     * OAuth code exchange.  The callback route needs to run without the\n     * middleware trying to refresh a session that doesn't exist yet.\n     */\n    '/auth/login',\n    '/auth/sign-up',\n    '/auth/extension-connected',\n    '/api/extension/:path*',\n    '/api/lemonsqueezy/:path*',\n  ],\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAAA;;;;AAEO,eAAe,WAAW,OAAoB;IACnD,IAAI;QACF,OAAO,MAAM,IAAA,iJAAa,EAAC;IAC7B,EAAE,OAAO,GAAG;QACV,+HAAM,CAAC,SAAS,CAAC,oBAAoB,GAAG;YAAE,MAAM,QAAQ,OAAO,CAAC,QAAQ;QAAC;QACzE,OAAO,gMAAY,CAAC,IAAI;IAC1B;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QACP;QACA;QACA;;;;KAIC,GACD;QACA;QACA;QACA;QACA;KACD;AACH"}}]
}