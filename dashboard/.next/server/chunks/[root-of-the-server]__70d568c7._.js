module.exports=[18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},40911,e=>{"use strict";function r(e,r,t){let s=JSON.stringify({level:e,event:r,timestamp:new Date().toISOString(),...t});switch(e){case"error":console.error(s);break;case"warn":console.warn(s);break;default:console.log(s)}}function t(e){return e.headers.get("x-forwarded-for")?.split(",")[0]?.trim()||e.headers.get("x-real-ip")||"unknown"}e.s(["getClientIp",()=>t,"logger",0,{info:(e,t)=>r("info",e,t),warn:(e,t)=>r("warn",e,t),error:(e,t)=>r("error",e,t),exception:(e,t,s)=>{r("error",e,{...t instanceof Error?{errorMessage:t.message,errorStack:t.stack}:{errorMessage:String(t)},...s})},security:(e,t)=>r("warn",e,{...t,security:!0})}])},54799,(e,r,t)=>{r.exports=e.x("crypto",()=>require("crypto"))},90500,98851,e=>{"use strict";function r(e){return{"Access-Control-Allow-Origin":e||"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Authorization","Access-Control-Max-Age":"86400",Vary:"Origin"}}e.s(["getCorsHeaders",()=>r],90500);var t=e.i(54799),s=e.i(24389);async function n(e){let r=e.headers.get("authorization");if(!r||!r.startsWith("Bearer "))return{valid:!1,error:"Missing or malformed Authorization header"};let n=r.slice(7).trim();if(!n||n.length<32)return{valid:!1,error:"Invalid token format"};let o=t.default.createHash("sha256").update(n).digest("hex"),a=(0,s.createClient)(process.env.NEXT_PUBLIC_SUPABASE_URL,process.env.SUPABASE_SERVICE_ROLE_KEY),{data:i,error:l}=await a.from("extension_tokens").select("user_id, expires_at").eq("token_hash",o).single();return l||!i?{valid:!1,error:"Invalid or expired token"}:new Date(i.expires_at)<new Date?(await a.from("extension_tokens").delete().eq("token_hash",o),{valid:!1,error:"Token has expired. Please reconnect in the extension."}):{valid:!0,userId:i.user_id}}e.s(["verifyExtensionToken",()=>n],98851)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__70d568c7._.js.map